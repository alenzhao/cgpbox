<html>
  <head>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <script src="../js/jquery-2.2.3.min.js"></script>
    <script src="../js/Chart.bundle.js"></script>
    <script>
      last_change = "-";
      progress = {"datasets":[{"borderWidth":1,"backgroundColor":"rgba(255,99,132,0.2)","hoverBorderColor":"rgba(255,99,132,1)","hoverBackgroundColor":"rgba(255,99,132,0.4)","borderColor":"rgba(255,99,132,1)","data":[0,0,0,0,0],"label":"Jobs Started"},{"hoverBackgroundColor":"rgba(75,192,192,0.4)","hoverBorderColor":"rgba(75,192,192,1)","backgroundColor":"rgba(75,192,192,0.2)","borderColor":"rgba(75,192,192,1)","data":[0,0,0,0,0],"label":"Jobs Completed","borderWidth":1}],"labels":["QC","ascat","pindel","caveman","brass"]}
    </script>
    <script>
      function reload_js(src) {
          $('script[src="' + src + '"]').remove();
          $('<script>').attr('src', src).appendTo('head');
      }
    </script>
    <script>
    $(document).ready(function () {
      (function countdown(remaining) {
          if(remaining <= 0)
              location.reload(true);
          document.getElementById('countdown').innerHTML = remaining;
          document.getElementById('last_mod').innerHTML = last_change;
          setTimeout(function(){ countdown(remaining - 1); }, 1000);
      })(30); // 5 seconds

      reload_js('../data/progress.js);

      // chart stuff
      var ctx = document.getElementById("myChart");
      var myBarChart = new Chart(ctx, {
        type: "bar",
        data: progress,
        options: {
          scales: {
            xAxes: [{
              stacked: true
            }],
            yAxes: [{
              stacked: true,
              type: "linear",
              ticks: {
                beginAtZero: true
              }
            }]
          }
        }
      });
    });
    </script>
  </head>
  <body>
    <div>Time to refresh: <span id="countdown">?</span></div>
    <div>Last status change: <span id="last_mod">?</span></div>
    <canvas id="myChart"></canvas>
  </body>
</html>
